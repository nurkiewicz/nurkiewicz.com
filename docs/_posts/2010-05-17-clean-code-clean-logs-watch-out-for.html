---
layout: post
title: 'Clean code, clean logs: watch out for external systems (8/10)'
date: '2010-05-17T22:46:00.006+02:00'
author: Tomasz Nurkiewicz
tags:
- esb
- apache cxf
- mule
- web services
- logging
modified_time: '2010-05-20T18:41:22.100+02:00'
blogger_id: tag:blogger.com,1999:blog-6753769565491687768.post-8466122454784362301
blogger_orig_url: https://www.nurkiewicz.com/2010/05/clean-code-clean-logs-watch-out-for.html
---

This is the special case of the previous <a href="http://nurkiewicz.blogspot.com/2010/05/clean-code-clean-logs-log-method.html">tip</a>: if you communicate with any external system, consider logging every piece of data that comes out from your application and gets in. Period. Integration is a tough job and diagnosing problems between two applications (think two different vendors, environments, technology stacks and teams) is particularly hard. Recently, for example, we've discovered that logging full messages contents, <a href="http://cxf.apache.org/docs/debugging-and-logging.html">including</a> SOAP and HTTP headers in <a href="http://cxf.apache.org">Apache CXF</a> web services is extremely useful during integration and system testing.<br /><br />This is a big overhead and if performance is an issue, you can always disable logging. But what is the point of having fast, but broken application, that no one can fix? Be extra careful when integrating with external systems and prepare to pay that cost. If you are lucky and all your integration is handled by ESB, bus is probably the best place to log every incoming request and response. See for example <a href="http://www.mulesoft.org">Mule</a>s' <a href="http://www.mulesoft.org/documentation/display/MULE2USER/Configuring+Components">&lt;log-component/&gt;</a>.<br /><br />Sometimes the amount of information exchanged with external systems makes it unacceptable to log everything. On the other hand during testing and for short period of time on production (for example when something wrong is happening) we would like to have everything saved in logs and are ready to pay performance cost. This can be achieved by carefully using logging levels. Just take a look at the following idiom:<br /><br /><pre class="brush: java">Collection&lt;Integer&gt; requestIds = //...<br /><br />if(log.isDebugEnabled())<br />    log.debug("Processing ids: {}", requestIds);<br />else<br />    log.info("Processing ids size: {}", requestIds.size());</pre><br /><br />If this particular logger is configured to log <span style="font-family: courier new;">DEBUG</span> messages, it will print the whole <span style="font-family: courier new;">requestIds</span> collection contents. But if it is configured to print <span style="font-family: courier new;">INFO</span> messages, only the size of collection will be outputted. If you are wondering why I forgot about <span style="font-family: courier new;">isInfoEnabled()</span> condition, go back to this <a href="http://nurkiewicz.blogspot.com/2010/05/clean-code-clean-logs-logging-levels.html">tip</a>. One thing worth mentioning is that <span style="font-family: courier new;">requestIds</span> collection should not be <span style="font-family: courier new;">null</span> in this case. Although it will be logged correctly as null if <span style="font-family: courier new;">DEBUG</span> is enabled, but big fat <span style="font-family: courier new;">NullPointerException</span> will be thrown if logger is configured to <span style="font-family: courier new;">INFO</span>. Remember my lesson about <a href="http://nurkiewicz.blogspot.com/2010/05/clean-code-clean-logs-avoid-side.html">side effects</a>?<br /><br /><br /><ul><br /><li><a href="http://nurkiewicz.blogspot.com/2010/05/clean-code-clean-logs-use-appropriate.html">Clean code, clean logs: use appropriate tools (1/10)</a></li><br /><li><a href="http://nurkiewicz.blogspot.com/2010/05/clean-code-clean-logs-logging-levels.html">Clean code, clean logs: logging levels are there for you (2/10)</a></li><br /><li><a href="http://nurkiewicz.blogspot.com/2010/05/clean-code-clean-logs-do-you-know-what.html">Clean code, clean logs: do you know what you are logging? (3/10)</a></li><br /><li><a href="http://nurkiewicz.blogspot.com/2010/05/clean-code-clean-logs-avoid-side.html">Clean code, clean logs: avoid side effects (4/10)</a></li><br /><li><a href="http://nurkiewicz.blogspot.com/2010/05/clean-code-clean-logs-concise-and.html">Clean code, clean logs: concise and descriptive (5/10)</a></li><br /><li><a href="http://nurkiewicz.blogspot.com/2010/05/clean-code-clean-logs-tune-your-pattern.html">Clean code, clean logs: tune your pattern (6/10)</a></li><br /><li><a href="http://nurkiewicz.blogspot.com/2010/05/clean-code-clean-logs-log-method.html">Clean code, clean logs: log method arguments and return values (7/10)</a></li><br /><li>Clean code, clean logs: watch out for external systems (8/10)</li><br /><li><a href="http://nurkiewicz.blogspot.com/2010/05/clean-code-clean-logs-log-exceptions.html">Clean code, clean logs: log exceptions properly (9/10)</a></li><br /><li><a href="http://nurkiewicz.blogspot.com/2010/05/clean-code-clean-logs-easy-to-read-easy.html">Clean code, clean logs: easy to read, easy to parse (10/10)</a></li><br /></ul>